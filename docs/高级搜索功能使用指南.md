# 高级搜索功能使用指南

## 功能概述

高级搜索功能为用户提供了强大而灵活的任务查找能力，支持多种搜索条件组合，帮助用户快速定位所需的任务。

## 功能特性

### 1. 基础搜索
- **关键词搜索**：在任务标题和描述中搜索关键词
- **状态筛选**：按任务状态筛选（待处理、进行中、已完成、已取消、待验证）
- **优先级筛选**：按优先级筛选（低、中、高、紧急）

### 2. 高级搜索选项
- **难度范围**：使用滑块选择难度范围（1-10）
- **奖励范围**：使用滑块选择奖励金额范围
- **创建者筛选**：按任务创建者地址搜索
- **执行者筛选**：按任务执行者地址搜索
- **截止日期范围**：选择截止日期时间范围
- **创建时间范围**：选择任务创建时间范围
- **特殊条件**：
  - 只显示有截止日期的任务
  - 只显示未分配的任务

### 3. 排序功能
支持按以下字段排序：
- 创建时间
- 更新时间
- 截止时间
- 奖励金额
- 难度等级
- 优先级

每个排序字段都支持升序和降序两种方式。

### 4. 分页功能
- 支持自定义每页显示数量（10/20/50/100）
- 快速跳转到指定页面
- 显示当前页面范围和总数

### 5. 快速搜索
- 在导航栏提供全局快速搜索
- 实时搜索建议
- 关键词高亮显示
- 点击结果直接跳转到任务详情

## 使用方法

### 基础搜索使用
1. 在任务列表页面找到"任务搜索"卡片
2. 在"关键词搜索"框中输入要搜索的内容
3. 选择任务状态和优先级（可选）
4. 点击"搜索"按钮

### 高级搜索使用
1. 点击"高级搜索选项"展开更多筛选条件
2. 根据需要设置各种筛选条件：
   - 拖动难度范围滑块选择合适的难度区间
   - 拖动奖励范围滑块选择合适的奖励区间
   - 输入创建者或执行者的地址
   - 选择时间范围
   - 开启特殊筛选条件
3. 选择排序方式和排序方向
4. 点击"搜索"按钮执行搜索

### 快速搜索使用
1. 在页面顶部导航栏的搜索框中输入关键词
2. 系统会实时显示搜索建议
3. 点击任意搜索结果可直接跳转到任务详情页面
4. 点击关闭按钮可关闭搜索结果面板

## 后端API接口

### 高级搜索
```rust
// 搜索任务
pub fn search_tasks(search_params: TaskSearchParams<T>) -> Vec<Task<T>>

// 获取搜索结果总数
pub fn count_search_results(search_params: TaskSearchParams<T>) -> u32

// 快速搜索
pub fn quick_search(keyword: Vec<u8>) -> Vec<Task<T>>

// 获取任务统计信息
pub fn get_task_statistics() -> TaskStatistics<T>
```

### 搜索参数结构
```rust
pub struct TaskSearchParams<T: Config> {
    pub keyword: Vec<u8>,                    // 关键词
    pub status: Option<u8>,                  // 状态
    pub priority: Option<u8>,                // 优先级
    pub difficulty_range: Option<(u8, u8)>,  // 难度范围
    pub reward_range: Option<(T::Balance, T::Balance)>, // 奖励范围
    pub creator: Option<T::AccountId>,       // 创建者
    pub assignee: Option<T::AccountId>,      // 执行者
    pub deadline_range: Option<(T::Moment, T::Moment)>, // 截止日期范围
    pub created_time_range: Option<(T::Moment, T::Moment)>, // 创建时间范围
    pub has_deadline: bool,                  // 只显示有截止日期的任务
    pub unassigned_only: bool,               // 只显示未分配的任务
    pub sort_by: TaskSortBy,                // 排序字段
    pub sort_desc: bool,                     // 是否降序
    pub page: usize,                         // 页码
    pub page_size: usize,                    // 每页大小
}
```

## 前端组件

### 主要组件
- `TaskSearchForm`：搜索表单组件
- `SearchResults`：搜索结果显示组件  
- `QuickSearch`：快速搜索组件

### 使用示例
```tsx
import TaskSearchForm from '../components/TaskSearchForm';
import SearchResults from '../components/SearchResults';

// 搜索处理函数
const handleSearch = async (filters: SearchFilters) => {
  // 执行搜索逻辑
  const results = await searchAPI(filters);
  setSearchResults(results);
};

// 渲染搜索表单
<TaskSearchForm 
  onSearch={handleSearch}
  onReset={handleReset}
  loading={loading}
/>

// 渲染搜索结果
<SearchResults
  tasks={searchResults}
  total={searchTotal}
  currentPage={currentPage}
  pageSize={pageSize}
  onPageChange={handlePageChange}
  onTaskClick={handleTaskClick}
/>
```

## 性能优化建议

### 后端优化
1. **索引优化**：为常用搜索字段创建数据库索引
2. **缓存机制**：对频繁搜索的结果进行缓存
3. **分页查询**：避免一次性返回大量数据
4. **异步处理**：对复杂搜索使用异步处理

### 前端优化
1. **防抖处理**：对搜索输入进行防抖，减少API调用
2. **虚拟滚动**：对大量搜索结果使用虚拟滚动
3. **懒加载**：搜索结果分页懒加载
4. **缓存结果**：缓存搜索结果，避免重复请求

## 扩展功能

### 已规划的功能
1. **保存搜索条件**：允许用户保存常用的搜索条件
2. **搜索历史**：记录用户的搜索历史
3. **智能推荐**：基于用户行为推荐相关任务
4. **全文搜索**：集成全文搜索引擎提升搜索精度

### 自定义扩展
开发者可以通过以下方式扩展搜索功能：
1. 在`TaskSearchParams`中添加新的搜索字段
2. 在搜索方法中实现对应的过滤逻辑
3. 在前端表单中添加新的搜索控件
4. 更新搜索结果显示逻辑

## 常见问题

### Q: 搜索结果为空怎么办？
A: 
1. 检查搜索条件是否过于严格
2. 尝试放宽筛选条件
3. 使用关键词搜索而不是精确匹配

### Q: 搜索速度较慢怎么办？
A:
1. 减少搜索条件的复杂度
2. 使用更具体的关键词
3. 联系管理员检查系统性能

### Q: 如何搜索特定时间段的任务？
A:
1. 展开高级搜索选项
2. 使用"截止日期范围"或"创建时间范围"筛选
3. 选择合适的时间区间

### Q: 快速搜索和高级搜索有什么区别？
A:
- 快速搜索：仅支持关键词搜索，适合快速查找
- 高级搜索：支持多种条件组合，适合精确查找

---

这个高级搜索功能为用户提供了强大的任务查找能力，通过合理使用各种筛选条件，可以快速定位到所需的任务，大大提升工作效率。 