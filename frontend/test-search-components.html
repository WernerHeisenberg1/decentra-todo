<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜çº§æœç´¢åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        
        .test-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #007bff;
        }
        
        .test-section h2 {
            margin-top: 0;
            color: #343a40;
        }
        
        .test-case {
            background: white;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid #dee2e6;
        }
        
        .test-case h3 {
            margin-top: 0;
            color: #495057;
            font-size: 16px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #495057;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 14px;
        }
        
        input[type="range"] {
            width: 100%;
        }
        
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
        }
        
        button:hover {
            background: #0056b3;
        }
        
        button.secondary {
            background: #6c757d;
        }
        
        button.secondary:hover {
            background: #545b62;
        }
        
        .results {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .task-item {
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 12px;
            margin-bottom: 10px;
            background: #f8f9fa;
        }
        
        .task-title {
            font-weight: 600;
            color: #212529;
            margin-bottom: 5px;
        }
        
        .task-meta {
            font-size: 12px;
            color: #6c757d;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .status-pending { background: #fff3cd; }
        .status-progress { background: #cce5ff; }
        .status-completed { background: #d4edda; }
        
        .highlight {
            background: yellow;
            font-weight: bold;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .stat-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 15px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #007bff;
        }
        
        .stat-label {
            font-size: 12px;
            color: #6c757d;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <h1>ğŸ” é«˜çº§æœç´¢åŠŸèƒ½æµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>1. åŸºç¡€æœç´¢è¡¨å•</h2>
        <div class="test-case">
            <h3>æœç´¢æ¡ä»¶</h3>
            <form id="searchForm">
                <div class="form-group">
                    <label for="keyword">å…³é”®è¯æœç´¢</label>
                    <input type="text" id="keyword" placeholder="æœç´¢ä»»åŠ¡æ ‡é¢˜æˆ–æè¿°...">
                </div>
                
                <div class="form-group">
                    <label for="status">ä»»åŠ¡çŠ¶æ€</label>
                    <select id="status">
                        <option value="">å…¨éƒ¨çŠ¶æ€</option>
                        <option value="0">å¾…å¤„ç†</option>
                        <option value="1">è¿›è¡Œä¸­</option>
                        <option value="2">å·²å®Œæˆ</option>
                        <option value="3">å·²å–æ¶ˆ</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="priority">ä¼˜å…ˆçº§</label>
                    <select id="priority">
                        <option value="">å…¨éƒ¨ä¼˜å…ˆçº§</option>
                        <option value="1">ä½</option>
                        <option value="2">ä¸­</option>
                        <option value="3">é«˜</option>
                        <option value="4">ç´§æ€¥</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="difficultyMin">éš¾åº¦èŒƒå›´: <span id="difficultyDisplay">1 - 10</span></label>
                    <input type="range" id="difficultyMin" min="1" max="10" value="1">
                    <input type="range" id="difficultyMax" min="1" max="10" value="10">
                </div>
                
                <div class="form-group">
                    <label for="rewardMin">å¥–åŠ±èŒƒå›´</label>
                    <input type="number" id="rewardMin" placeholder="æœ€å°å¥–åŠ±" min="0">
                    <input type="number" id="rewardMax" placeholder="æœ€å¤§å¥–åŠ±" min="0">
                </div>
                
                <div class="form-group">
                    <label for="creator">åˆ›å»ºè€…åœ°å€</label>
                    <input type="text" id="creator" placeholder="è¾“å…¥åˆ›å»ºè€…åœ°å€...">
                </div>
                
                <div class="form-group">
                    <label for="sortBy">æ’åºæ–¹å¼</label>
                    <select id="sortBy">
                        <option value="created_at">åˆ›å»ºæ—¶é—´</option>
                        <option value="reward">å¥–åŠ±é‡‘é¢</option>
                        <option value="difficulty">éš¾åº¦</option>
                        <option value="priority">ä¼˜å…ˆçº§</option>
                        <option value="deadline">æˆªæ­¢æ—¶é—´</option>
                    </select>
                    <label>
                        <input type="checkbox" id="sortDesc" checked> é™åºæ’åˆ—
                    </label>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="unassignedOnly"> ä»…æ˜¾ç¤ºæœªåˆ†é…ä»»åŠ¡
                    </label>
                </div>
                
                <button type="submit">æœç´¢</button>
                <button type="button" class="secondary" onclick="resetForm()">é‡ç½®</button>
            </form>
        </div>
    </div>
    
    <div class="test-section">
        <h2>2. å¿«é€Ÿæœç´¢</h2>
        <div class="test-case">
            <h3>å¿«é€Ÿæœç´¢æ¡†</h3>
            <div class="form-group">
                <input type="text" id="quickSearch" placeholder="å¿«é€Ÿæœç´¢ä»»åŠ¡...">
                <button onclick="performQuickSearch()">æœç´¢</button>
            </div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>3. æœç´¢ç»“æœ</h2>
        <div id="searchResults" class="results">
            <p>è¯·è¾“å…¥æœç´¢æ¡ä»¶å¹¶ç‚¹å‡»æœç´¢æŒ‰é’®</p>
        </div>
    </div>
    
    <div class="test-section">
        <h2>4. ä»»åŠ¡ç»Ÿè®¡</h2>
        <div id="taskStats" class="stats-grid">
            <!-- ç»Ÿè®¡å¡ç‰‡å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
        </div>
    </div>

    <script>
        // æ¨¡æ‹Ÿä»»åŠ¡æ•°æ®
        const mockTasks = [
            {
                id: 1,
                title: 'Frontend React Development',
                description: 'Build modern React components with TypeScript',
                creator: 'alice',
                assignee: null,
                status: 0,
                priority: 3,
                difficulty: 7,
                reward: 500,
                deadline: Date.now() + 7 * 24 * 60 * 60 * 1000,
                created_at: Date.now() - 24 * 60 * 60 * 1000,
            },
            {
                id: 2,
                title: 'Backend API Development',
                description: 'Create REST API endpoints for React frontend',
                creator: 'bob',
                assignee: 'charlie',
                status: 1,
                priority: 2,
                difficulty: 6,
                reward: 400,
                deadline: Date.now() + 5 * 24 * 60 * 60 * 1000,
                created_at: Date.now() - 2 * 24 * 60 * 60 * 1000,
            },
            {
                id: 3,
                title: 'Database Schema Design',
                description: 'Design PostgreSQL schema for the application',
                creator: 'alice',
                assignee: null,
                status: 0,
                priority: 1,
                difficulty: 4,
                reward: 200,
                deadline: Date.now() + 10 * 24 * 60 * 60 * 1000,
                created_at: Date.now() - 5 * 24 * 60 * 60 * 1000,
            },
            {
                id: 4,
                title: 'Mobile App Development',
                description: 'Create React Native mobile application',
                creator: 'charlie',
                assignee: null,
                status: 0,
                priority: 4,
                difficulty: 8,
                reward: 600,
                deadline: Date.now() + 3 * 24 * 60 * 60 * 1000,
                created_at: Date.now() - 3 * 24 * 60 * 60 * 1000,
            },
            {
                id: 5,
                title: 'UI/UX Design',
                description: 'Design user interface mockups and prototypes',
                creator: 'bob',
                assignee: 'dave',
                status: 2,
                priority: 2,
                difficulty: 5,
                reward: 300,
                deadline: Date.now() + 14 * 24 * 60 * 60 * 1000,
                created_at: Date.now() - 14 * 24 * 60 * 60 * 1000,
            },
        ];

        // æœç´¢å‡½æ•°
        function searchTasks(searchParams) {
            let filteredTasks = [...mockTasks];

            // å…³é”®è¯æœç´¢
            if (searchParams.keyword) {
                filteredTasks = filteredTasks.filter(task => {
                    const keyword = searchParams.keyword.toLowerCase();
                    return task.title.toLowerCase().includes(keyword) ||
                           task.description.toLowerCase().includes(keyword);
                });
            }

            // çŠ¶æ€ç­›é€‰
            if (searchParams.status !== '') {
                filteredTasks = filteredTasks.filter(task => task.status == searchParams.status);
            }

            // ä¼˜å…ˆçº§ç­›é€‰
            if (searchParams.priority !== '') {
                filteredTasks = filteredTasks.filter(task => task.priority == searchParams.priority);
            }

            // éš¾åº¦èŒƒå›´ç­›é€‰
            if (searchParams.difficultyMin || searchParams.difficultyMax) {
                const min = searchParams.difficultyMin || 1;
                const max = searchParams.difficultyMax || 10;
                filteredTasks = filteredTasks.filter(task => 
                    task.difficulty >= min && task.difficulty <= max
                );
            }

            // å¥–åŠ±èŒƒå›´ç­›é€‰
            if (searchParams.rewardMin || searchParams.rewardMax) {
                const min = searchParams.rewardMin || 0;
                const max = searchParams.rewardMax || Infinity;
                filteredTasks = filteredTasks.filter(task => 
                    task.reward >= min && task.reward <= max
                );
            }

            // åˆ›å»ºè€…ç­›é€‰
            if (searchParams.creator) {
                filteredTasks = filteredTasks.filter(task => 
                    task.creator.toLowerCase().includes(searchParams.creator.toLowerCase())
                );
            }

            // æœªåˆ†é…ç­›é€‰
            if (searchParams.unassignedOnly) {
                filteredTasks = filteredTasks.filter(task => !task.assignee);
            }

            // æ’åº
            if (searchParams.sortBy) {
                filteredTasks.sort((a, b) => {
                    let aValue = a[searchParams.sortBy];
                    let bValue = b[searchParams.sortBy];
                    
                    if (searchParams.sortDesc) {
                        return bValue - aValue;
                    } else {
                        return aValue - bValue;
                    }
                });
            }

            return filteredTasks;
        }

        // å¿«é€Ÿæœç´¢
        function quickSearch(keyword) {
            if (!keyword) return [];
            
            return mockTasks.filter(task => {
                const keywordLower = keyword.toLowerCase();
                return task.title.toLowerCase().includes(keywordLower) ||
                       task.description.toLowerCase().includes(keywordLower);
            });
        }

        // é«˜äº®å…³é”®è¯
        function highlightKeyword(text, keyword) {
            if (!keyword) return text;
            
            const regex = new RegExp(`(${keyword})`, 'gi');
            return text.replace(regex, '<span class="highlight">$1</span>');
        }

        // æ¸²æŸ“æœç´¢ç»“æœ
        function renderResults(tasks, keyword = '') {
            const resultsContainer = document.getElementById('searchResults');
            
            if (tasks.length === 0) {
                resultsContainer.innerHTML = '<p>æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ä»»åŠ¡</p>';
                return;
            }

            const statusNames = ['å¾…å¤„ç†', 'è¿›è¡Œä¸­', 'å·²å®Œæˆ', 'å·²å–æ¶ˆ'];
            const priorityNames = ['', 'ä½', 'ä¸­', 'é«˜', 'ç´§æ€¥'];
            
            let html = `<h3>æ‰¾åˆ° ${tasks.length} ä¸ªä»»åŠ¡</h3>`;
            
            tasks.forEach(task => {
                const statusClass = `status-${['pending', 'progress', 'completed', 'cancelled'][task.status]}`;
                const title = highlightKeyword(task.title, keyword);
                const description = highlightKeyword(task.description, keyword);
                
                html += `
                    <div class="task-item ${statusClass}">
                        <div class="task-title">${title}</div>
                        <div>${description}</div>
                        <div class="task-meta">
                            <span>çŠ¶æ€: ${statusNames[task.status]}</span>
                            <span>ä¼˜å…ˆçº§: ${priorityNames[task.priority]}</span>
                            <span>éš¾åº¦: ${task.difficulty}/10</span>
                            <span>å¥–åŠ±: ${task.reward}</span>
                            <span>åˆ›å»ºè€…: ${task.creator}</span>
                            ${task.assignee ? `<span>æ‰§è¡Œè€…: ${task.assignee}</span>` : '<span>æœªåˆ†é…</span>'}
                        </div>
                    </div>
                `;
            });
            
            resultsContainer.innerHTML = html;
        }

        // æ¸²æŸ“ç»Ÿè®¡ä¿¡æ¯
        function renderStats() {
            const totalTasks = mockTasks.length;
            const pendingCount = mockTasks.filter(t => t.status === 0).length;
            const inProgressCount = mockTasks.filter(t => t.status === 1).length;
            const completedCount = mockTasks.filter(t => t.status === 2).length;
            const totalReward = mockTasks.reduce((sum, task) => sum + task.reward, 0);
            const avgDifficulty = totalTasks > 0 ? 
                Math.round(mockTasks.reduce((sum, task) => sum + task.difficulty, 0) / totalTasks) : 0;
            const unassignedCount = mockTasks.filter(t => !t.assignee).length;

            const statsContainer = document.getElementById('taskStats');
            
            statsContainer.innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">${totalTasks}</div>
                    <div class="stat-label">æ€»ä»»åŠ¡æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${pendingCount}</div>
                    <div class="stat-label">å¾…å¤„ç†</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${inProgressCount}</div>
                    <div class="stat-label">è¿›è¡Œä¸­</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${completedCount}</div>
                    <div class="stat-label">å·²å®Œæˆ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${totalReward}</div>
                    <div class="stat-label">æ€»å¥–åŠ±</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${avgDifficulty}</div>
                    <div class="stat-label">å¹³å‡éš¾åº¦</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${unassignedCount}</div>
                    <div class="stat-label">æœªåˆ†é…</div>
                </div>
            `;
        }

        // è¡¨å•æäº¤å¤„ç†
        document.getElementById('searchForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const searchParams = {
                keyword: document.getElementById('keyword').value,
                status: document.getElementById('status').value,
                priority: document.getElementById('priority').value,
                difficultyMin: parseInt(document.getElementById('difficultyMin').value),
                difficultyMax: parseInt(document.getElementById('difficultyMax').value),
                rewardMin: parseInt(document.getElementById('rewardMin').value) || 0,
                rewardMax: parseInt(document.getElementById('rewardMax').value) || Infinity,
                creator: document.getElementById('creator').value,
                sortBy: document.getElementById('sortBy').value,
                sortDesc: document.getElementById('sortDesc').checked,
                unassignedOnly: document.getElementById('unassignedOnly').checked,
            };
            
            const results = searchTasks(searchParams);
            renderResults(results, searchParams.keyword);
        });

        // å¿«é€Ÿæœç´¢
        function performQuickSearch() {
            const keyword = document.getElementById('quickSearch').value;
            const results = quickSearch(keyword);
            renderResults(results, keyword);
        }

        // é‡ç½®è¡¨å•
        function resetForm() {
            document.getElementById('searchForm').reset();
            document.getElementById('searchResults').innerHTML = '<p>è¯·è¾“å…¥æœç´¢æ¡ä»¶å¹¶ç‚¹å‡»æœç´¢æŒ‰é’®</p>';
            updateDifficultyDisplay();
        }

        // æ›´æ–°éš¾åº¦æ˜¾ç¤º
        function updateDifficultyDisplay() {
            const min = document.getElementById('difficultyMin').value;
            const max = document.getElementById('difficultyMax').value;
            document.getElementById('difficultyDisplay').textContent = `${min} - ${max}`;
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // ç›‘å¬éš¾åº¦æ»‘å—å˜åŒ–
            document.getElementById('difficultyMin').addEventListener('input', updateDifficultyDisplay);
            document.getElementById('difficultyMax').addEventListener('input', updateDifficultyDisplay);
            
            // å¿«é€Ÿæœç´¢å›è½¦äº‹ä»¶
            document.getElementById('quickSearch').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    performQuickSearch();
                }
            });
            
            // åˆå§‹åŒ–ç»Ÿè®¡ä¿¡æ¯
            renderStats();
            
            // åˆå§‹æ˜¾ç¤ºæ‰€æœ‰ä»»åŠ¡
            renderResults(mockTasks);
        });
    </script>
</body>
</html> 